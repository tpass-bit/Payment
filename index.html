<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SuzzyPay • Secure Firebase Wallet</title>

  <!-- core libs -->
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode@3.5.1/build/qrcode.min.js"></script>
  <!-- QR‑scanner lib -->
  <script src="https://unpkg.com/html5-qrcode@2.3.9/html5-qrcode.min.js"></script>
  <!-- crypto‑js for PIN hashing -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

  <!-- fonts & icons -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto+Mono&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  
  <!-- styles -->
  <link rel="stylesheet" href="css/style.css" />
</head>
<body class="dark">
<div class="container">
  <header>
    <div class="logo"><i class="fas fa-wallet"></i><span>SuzzyPay</span></div>
    <button class="theme-toggle" id="themeToggle"><i class="fas fa-moon"></i></button>
  </header>

  <!-- Wallet Section -->
  <div class="card" id="walletCard">
    <h2 class="card-title"><i class="fas fa-key"></i> Wallet</h2>
    <div id="walletNotFound">
      <button class="btn btn-primary btn-block" onclick="createOrLoadUniqueWallet()"><i class="fas fa-user-plus"></i> Generate&nbsp;Wallet</button>
      <div class="form-group"><input id="importKey" placeholder="Paste backup JSON here"/></div>
      <button class="btn btn-secondary btn-block" onclick="importBackup()"><i class="fas fa-file-import"></i> Restore&nbsp;Backup</button>
    </div>

    <div id="walletLoaded" class="hidden">
      <div class="form-group"><label>Your Address</label>
        <div class="address-display"><span id="addr">...</span>
          <button class="copy-btn" onclick="copy('addr')"><i class="far fa-copy"></i></button>
        </div>
      </div>
      <div class="qr-container"><canvas id="qr"></canvas></div>
      <button class="btn btn-secondary btn-block" onclick="exportBackup()"><i class="fas fa-download"></i> Export&nbsp;Backup</button>
      <button class="btn btn-danger btn-block" onclick="wipeWallet()"><i class="fas fa-trash"></i> Forget&nbsp;Wallet</button>
    </div>
  </div>

  <!-- Balance -->
  <div class="card hidden" id="balanceCard">
    <h2 class="card-title"><i class="fas fa-coins"></i> Balance</h2>
    <div class="balance-display" id="bal">0 SUZ</div>
    <button class="btn btn-primary btn-block" onclick="loadBalance()"><i class="fas fa-sync-alt"></i> Refresh</button>
  </div>

  <!-- Send -->
  <div class="card hidden" id="sendCard">
    <h2 class="card-title"><i class="fas fa-paper-plane"></i> Send SUZ</h2>
    <div class="form-group"><input id="to" placeholder="Receiver SUZ_…"></div>
    <div class="form-group"><input id="amt" type="number" placeholder="Amount" step="1"></div>
    <button class="btn btn-secondary btn-block" onclick="openScanner()"><i class="fas fa-camera"></i> Scan&nbsp;QR</button>
    <button class="btn btn-primary btn-block" onclick="sendToken()"><i class="fas fa-lock"></i> Send&nbsp;(PIN)</button>
  </div>

  <!-- History -->
  <div class="card hidden" id="histCard">
    <h2 class="card-title"><i class="fas fa-history"></i> History</h2>
    <div class="history-tabs">
      <button class="tab-btn active" onclick="showHistoryTab('all')">All</button>
      <button class="tab-btn" onclick="showHistoryTab('sent')">Sent</button>
      <button class="tab-btn" onclick="showHistoryTab('received')">Received</button>
    </div>
    <ul class="tx-list" id="txList"></ul>
    <div id="noTx" class="alert alert-info">No transactions yet.</div>
  </div>

  <!-- Log -->
  <div class="card" id="logCard">
    <h2 class="card-title"><i class="fas fa-terminal"></i> Log</h2>
    <pre id="log"></pre>
  </div>
</div>

<!-- Scanner Modal -->
<div id="scannerModal" class="modal">
  <div class="modal-content">
    <div id="scanner"></div>
    <button class="btn btn-danger" id="scannerClose" onclick="closeScanner()">Close</button>
  </div>
</div>

<!-- Payment Success Overlay -->
<div id="paymentSuccess" class="payment-overlay hidden">
  <div class="payment-content">
    <div class="success-animation">
      <svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">
        <circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/>
        <path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/>
      </svg>
      <div class="particles">
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
      </div>
    </div>
    <h2>Payment Successful!</h2>
    <p id="successMessage">Your transaction has been completed</p>
    <button class="btn btn-primary" onclick="hidePaymentSuccess()">Done</button>
  </div>
</div>

<script src="js/app.js"></script>
</body>
</html>
